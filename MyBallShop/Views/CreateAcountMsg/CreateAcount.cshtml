@{
	Layout = null;
}

<style>
	.frm_controls .add {
		width:130px;
	}
</style>

<head>
	<meta charset="UTF-8"/>
	<title></title>
	<link rel="stylesheet" href="~/Content/css/acount/base.css"/>
	<link rel="stylesheet" href="~/Content/css/acount/layout.css"/>
	<script src="~/Scripts/jquery-1.10.2.js"></script>
	<script src="~/Scripts/PCASClass.js"></script>
	<script src="~/Scripts/gVerify.js"></script>
</head>
<body style="background-image:url(/Content/images/pexels-photo-305244.jpeg);background-repeat:no-repeat; background-size:100% 100%;-moz-background-size:100% 100%;">
	<div id="wrapper">
		<header id="header">
			<div id="loginBar">
				<div class="w960 tr">
					<a style="color:white !important;">已有账号?</a><span class="sp">|</span><a href="/Home/Login" style="color:white !important;">登录</a>
				</div>
			</div>
		</header><!-- // header end -->
		<div class="container w960 mt20">
			<div id="processor">
				<ol class="processorBox oh">
					<li class="current">
						<div class="step_inner fl">
							<span class="icon_step">1</span>
							<h4>基本信息</h4>
						</div>
					</li>
					<li>
						<div class="step_inner">
							<span class="icon_step">2</span>
							<h4>邮箱激活</h4>
						</div>
					</li>
					<li>
						<div class="step_inner fr">
							<span class="icon_step">3</span>
							<h4>完善资料</h4>
						</div>
					</li>
				</ol>
				<div class="step_line"></div>
			</div>
			<div class="content">
				<div id="step1" class="step hide">
					<form action="" method="post" id="step1_frm">
						<div class="frm_control_group">
							<label class="frm_label">邮箱</label>
							<div class="frm_controls">
								<input type="text" name="" class="frm_input email" maxlength="32" />
								<p class="frm_tips">*作为登录帐号，请填写未被微信开放平台注册、未被微信公众平台注册、未被微信私人帐号绑定的邮箱</p>
							</div>
						</div>
						<div class="frm_control_group">
							<label class="frm_label">密码</label>
							<div class="frm_controls">
								<input type="password" name="" class="frm_input passwd" />
								<p class="frm_tips">*字母、数字或者英文符号，最短6位，区分大小写</p>
							</div>
						</div>
						<div class="frm_control_group">
							<label class="frm_label">再次输入密码</label>
							<div class="frm_controls">
								<input type="password" name="" class="frm_input passwd2" />
							</div>
						</div>
						<div class="frm_control_group">
							<label class="frm_label">验证码</label>
							<div class="frm_controls verifycode">
								<input type="text" name="" class="frm_input verifyCode"/>
								<div id="v_container" style="width: 200px;height: 40px;"></div>
								<a class="changeVerifyCode" onclick="changeVerifyCode()">换一张</a>
							</div>
						</div>
						<div class="toolBar">
							<a id="nextBtn" class="btn btn_primary" href="javascript:;">下一步</a>
						</div>
					</form>
				</div><!-- // step1 end -->
				<div id="step2" class="step hide">
					<div class="w330">
						<strong class="f16">感谢注册，确认邮件已发送至你的注册邮箱<br/><span id="emailTwo">haibao1024@gmail.com</span></strong>
						<p class="c7b">请进入邮箱查看邮件</p>
						<p><a id="btn_emailcheck" class="btn btn_primary mt20" href="javascript:;">完善资料</a></p>
						<p class="c7b mt20">没有收到邮件？</p>
						<p>1. 请检查邮箱地址是否正确，你可以返回 <a href="#" class="c46">重新填写</a></p>
						<p>2. 检查你的邮件垃圾箱</p>
						<p>3. 若仍未收到确认，请尝试 <a href="#" class="c46">重新发送</a></p>
					</div>
				</div><!-- // step2 end -->
				<div id="step3" class="step hide">
					<form action="" method="post" id="step3_frm">
						<div class="frm_control_group">
							<label class="frm_label">姓名</label>
							<div class="frm_controls">
								<input type="text" name="" class="frm_input name" maxlength="32" />
								<p class="frm_tips">*请填写姓名</p>
							</div>
						</div>
						<div class="frm_control_group">
							<label class="frm_label">手机号</label>
							<div class="frm_controls">
								<input type="text" name="" class="frm_input phone" />
								<p class="frm_tips">*请填写常用手机号</p>
							</div>
						</div>
						<div class="frm_control_group">
							<label class="frm_label">地址</label>
							<div class="frm_controls">
								<select name="province" class="frm_input add"></select>
								<select name="city" class="frm_input add"></select>
								<select name="area" class="frm_input add"></select>
								<input type="text" name="" class="frm_input addr" style="width:280px !important;" placeholder="*详细地址"/>
								<p class="frm_tips">*请填写常用收货地址</p>
							</div>
						</div>
						<div class="frm_control_group">
							<label class="frm_label">手机验证码</label>
							<div class="frm_controls">
								<input type="text" name="" class="frm_input phoneYzm" />
								<input type="button" value="获取验证码" class="btn btn_default" />
							</div>
						</div>
						<div class="toolBar">
							<a id="finishedBtn" class="btn btn_primary" href="javascript:;">完成</a>
							<input id="mguid" type="hidden" name="MGUID" value="value">
						</div>
					</form>
				</div><!-- // step3 end -->
			</div>
		</div><!-- // container end -->
		<!-- // footer end -->
	</div><!-- // wrapper end -->

	<script>

		var verifyCode = new GVerify("v_container");
		new PCAS("province", "city", "area", "北京市");
		//显示提示框，目前三个参数(txt：要显示的文本；time：自动关闭的时间（不设置的话默认1500毫秒）；status：默认0为错误提示，1为正确提示；)
		function showTips(txt,time,status)
		{
			var htmlCon = '';
			if(txt != ''){
				if(status != 0 && status != undefined){
					htmlCon = '<div class="tipsBox" style="width:220px;padding:10px;background-color:#4AAF33;border-radius:4px;-webkit-border-radius: 4px;-moz-border-radius: 4px;color:#fff;box-shadow:0 0 3px #ddd inset;-webkit-box-shadow: 0 0 3px #ddd inset;text-align:center;position:fixed;top:25%;left:50%;z-index:999999;margin-left:-120px;"><img src="" style="vertical-align: middle;margin-right:5px;"/>' + txt + '</div>';
				}else{
					htmlCon = '<div class="tipsBox" style="width:220px;padding:10px;background-color:#D84C31;border-radius:4px;-webkit-border-radius: 4px;-moz-border-radius: 4px;color:#fff;box-shadow:0 0 3px #ddd inset;-webkit-box-shadow: 0 0 3px #ddd inset;text-align:center;position:fixed;top:25%;left:50%;z-index:999999;margin-left:-120px;"><img src="" style="vertical-align: middle;margin-right:5px;"/>' + txt + '</div>';
				}
				$('body').prepend(htmlCon);
				if(time == '' || time == undefined){
					time = 1500;
				}
				setTimeout(function(){ $('.tipsBox').remove(); },time);
			}
		}

		//更换验证码
		var changeVerifyCode = function () {
			verifyCode = new GVerify("v_container");
		}

		$(function(){
			//AJAX提交以及验证表单
			$('#nextBtn').click(function () {
				var obj = new Object();
				var email = $('.email').val();
				var passwd = $('.passwd').val();
				var passwd2 = $('.passwd2').val();
				var EmailReg = /^\w+([-+.]\w+)*@@\w+([-.]\w+)*\.\w+([-.]\w+)*$/; //邮件正则
				if(email == ''){
					showTips('请填写邮箱');
				}else if(!EmailReg.test(email)){
					showTips('邮箱格式错误');
				}else if(passwd == ''){
					showTips('请填写密码');
				}else if(passwd2 == ''){
					showTips('请再次输入密码');
				}else if(passwd != passwd2 || passwd2 != passwd){
					showTips('两次密码输入不一致');
				} else if (!verifyCode.validate($("input.verifyCode").val())) {
					showTips('验证错误');
				} else {
					obj["EMAILID"] = email;
					obj["PASSWORD"] = passwd;
					$.post("../CreateAcountMsg/CreateAccount", { model: obj }, function (data) {
						debugger
						if (data.toString().indexOf("error")>-1) {
							//登录失败
							showTips('登陆失败......');
						} else {
							showTips('提交成功', 2500, 1);
							$("#emailTwo").text(data.split('&')[1]);
							$("#mguid").val(data.split('&')[0]);
							$('.processorBox li').removeClass('current').eq(1).addClass('current');
							$('.step').fadeOut(300).eq(1).fadeIn(500);
						}
					});
				}
			});

			$("#btn_emailcheck").click(function () {
				showTips('登录成功', 2500, 1);
				//下一步
				$('.processorBox li').removeClass('current').eq(2).addClass('current');
				$('.step').fadeOut(300).eq(2).fadeIn(500);
			});

			$("#finishedBtn").click(function () {
				debugger
				var guid = $("#mguid").val();
				var email = $("#emailTwo").text();
				var name = $(".frm_input.name").val();
				var phone = $(".frm_input.phone").val();
				var addr = $("select[name='province']").find("option:selected").val() + $("select[name='city']").find("option:selected").val() +
				$("select[name='area']").find("option:selected").val() + $("input.addr").val();
				var OBJ = new Object();
				obj["GUID"] = guid;
				obj["EMAILID"] = email;
				obj["PHONENUMBER"] = phone;
				obj["ADDRESS"] = addr;
				obj["NAME"] = name;
				$.post("../CreateAcountMsg/UpdateAccount", { model: OBJ }, function (data) {
					//
				})
			   });

			//切换步骤（目前只用来演示）
			$('.processorBox li').click(function () {
				var b = $('.processorBox li.current').index();
				var i = $(this).index();
				if (i < b) {
					$('.processorBox li').removeClass('current').eq(i).addClass('current');
					$('.step').fadeOut(300).eq(i).fadeIn(500);
				}
			});
		});
	</script>
</body>